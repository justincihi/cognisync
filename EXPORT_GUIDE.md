# Export & Download Guide - Cognisync™

## Overview

Cognisync™ now includes comprehensive export and download functionality, allowing you to save session analyses in multiple formats for record-keeping, sharing, and compliance purposes.

## Supported Export Formats

### 1. **PDF (Portable Document Format)**
- Professional formatted document
- Includes session information, analysis, and sentiment data
- Ideal for: Client records, insurance submissions, legal documentation

### 2. **Markdown (.md)**
- Plain text with formatting
- Easy to read and edit
- Ideal for: Note-taking, version control, collaborative editing

### 3. **Text (.txt)**
- Simple plain text format
- Universal compatibility
- Ideal for: Quick reference, email attachments, archival

### 4. **Word Document (.docx)**
- Microsoft Word format
- Fully editable with formatting
- Ideal for: Report writing, further editing, professional documentation

### 5. **JSON (Session Data)**
- Complete session data in JSON format
- Includes all metadata and analysis
- Ideal for: Data backup, integration with other systems, research

## API Endpoints

### Export Session Analysis

**Endpoint:** `GET /api/sessions/<session_id>/export/<format>`

**Authentication:** Required (JWT token)

**Parameters:**
- `session_id` (integer): The database ID of the therapy session
- `format` (string): Export format - `pdf`, `markdown`, `md`, `txt`, `docx`

**Example:**
```bash
# Export as PDF
curl -H "Authorization: Bearer YOUR_TOKEN" \
  https://cognisync.example.com/api/sessions/1/export/pdf \
  -o session_analysis.pdf

# Export as Markdown
curl -H "Authorization: Bearer YOUR_TOKEN" \
  https://cognisync.example.com/api/sessions/1/export/markdown \
  -o session_analysis.md

# Export as Word Document
curl -H "Authorization: Bearer YOUR_TOKEN" \
  https://cognisync.example.com/api/sessions/1/export/docx \
  -o session_analysis.docx
```

### Download Session Data (JSON)

**Endpoint:** `GET /api/sessions/<session_id>/download`

**Authentication:** Required (JWT token)

**Response:**
```json
{
  "success": true,
  "session": {
    "id": 1,
    "session_id": "session_20251012_143022",
    "user_id": 1,
    "client_name": "John Doe",
    "therapy_type": "CBT",
    "summary_format": "SOAP",
    "transcript": "Session transcript...",
    "analysis": "Clinical analysis...",
    "sentiment_analysis": {...},
    "confidence_score": 92,
    "created_at": "2025-10-12 14:30:22",
    "file_path": "uploads/1_20251012_143022_session.mp3"
  }
}
```

## Export Content Structure

All exported documents include:

### Session Information
- Client name
- Session ID
- Therapy type (CBT, DBT, ACT, etc.)
- Documentation format (SOAP, BIRP, etc.)
- Session date and time
- AI confidence score

### Transcript
- Full or partial session transcript
- Audio file information
- Processing notes

### Clinical Analysis
- Complete SOAP/BIRP notes
- Assessment and observations
- Treatment plan and recommendations
- Clinical impressions

### Sentiment Analysis
- Emotional state tracking
- Mood indicators
- Sentiment trends
- Risk factors (if applicable)

### Validation Notes
- AI uncertainty flags
- Areas requiring review
- Clinician validation status

### Footer
- Generated by Cognisync™ branding
- Professional use disclaimer
- Generation timestamp

## Usage Examples

### JavaScript/Frontend

```javascript
// Export as PDF
async function exportToPDF(sessionId) {
  const response = await fetch(`/api/sessions/${sessionId}/export/pdf`, {
    headers: {
      'Authorization': `Bearer ${token}`
    }
  });
  
  const blob = await response.blob();
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `session_${sessionId}.pdf`;
  a.click();
}

// Export as Markdown
async function exportToMarkdown(sessionId) {
  const response = await fetch(`/api/sessions/${sessionId}/export/markdown`, {
    headers: {
      'Authorization': `Bearer ${token}`
    }
  });
  
  const blob = await response.blob();
  const url = window.URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `session_${sessionId}.md`;
  a.click();
}

// Download session data as JSON
async function downloadSessionData(sessionId) {
  const response = await fetch(`/api/sessions/${sessionId}/download`, {
    headers: {
      'Authorization': `Bearer ${token}`
    }
  });
  
  const data = await response.json();
  console.log(data.session);
}
```

### Python Example

```python
import requests

token = "your_jwt_token_here"
headers = {"Authorization": f"Bearer {token}"}
session_id = 1

# Export as PDF
response = requests.get(
    f"https://cognisync.example.com/api/sessions/{session_id}/export/pdf",
    headers=headers
)
with open(f"session_{session_id}.pdf", "wb") as f:
    f.write(response.content)

# Export as DOCX
response = requests.get(
    f"https://cognisync.example.com/api/sessions/{session_id}/export/docx",
    headers=headers
)
with open(f"session_{session_id}.docx", "wb") as f:
    f.write(response.content)

# Download session data
response = requests.get(
    f"https://cognisync.example.com/api/sessions/{session_id}/download",
    headers=headers
)
session_data = response.json()['session']
print(session_data)
```

## Security & Privacy

### Access Control
- Users can only export their own sessions
- Admin users can export any session (for support)
- All exports require valid JWT authentication

### Data Protection
- Exports contain sensitive client information
- Files should be stored securely
- Consider encryption for storage and transmission
- Follow HIPAA guidelines for PHI handling

### Audit Trail
- All export operations are logged
- Includes user ID, session ID, format, and timestamp
- Available in admin dashboard for compliance

## Best Practices

### For Clinicians
1. **Export Regularly**: Download important sessions for backup
2. **Use Appropriate Formats**: PDF for official records, Markdown for notes
3. **Secure Storage**: Store exported files in HIPAA-compliant systems
4. **Review Before Sharing**: Always review AI-generated content before sharing
5. **Version Control**: Use Markdown format for tracking changes over time

### For Administrators
1. **Monitor Usage**: Track export frequency and patterns
2. **Set Policies**: Establish guidelines for export and storage
3. **Backup Strategy**: Regular backups of session data
4. **Compliance**: Ensure exports meet regulatory requirements
5. **Training**: Educate users on proper export procedures

## Troubleshooting

### Export Fails
- **Check Authentication**: Ensure JWT token is valid
- **Verify Permissions**: Confirm you have access to the session
- **Session Exists**: Verify the session ID is correct
- **Format Supported**: Use only supported formats (pdf, md, txt, docx, json)

### Missing Content
- **Incomplete Analysis**: Session may not be fully processed
- **No Transcript**: Audio file may not have been transcribed
- **Sentiment Data**: May not be available for all sessions

### Format Issues
- **PDF Not Rendering**: Check fpdf2 installation
- **DOCX Errors**: Verify python-docx is installed
- **Encoding Problems**: Ensure UTF-8 encoding for text exports

## Dependencies

The export functionality requires:
- `fpdf2==2.7.9` - PDF generation
- `python-docx==1.1.0` - Word document generation

These are automatically installed with Cognisync™.

## Future Enhancements

Planned features:
- Batch export (multiple sessions at once)
- Custom templates for exports
- Email delivery of exports
- Cloud storage integration (Dropbox, Google Drive)
- Encrypted exports with password protection
- Export scheduling and automation

---

**Last Updated:** October 15, 2025  
**Version:** 3.2.0

For questions or issues, please refer to the main documentation or contact support.

